<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Resmia Hire</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,700,900" rel="stylesheet"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"/>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="/css/index.css"/>
</head>
<body>
<div class="dashboard">
	<div class="logo">
		<img src="/images/logo.png" alt="logo" />
	</div>
	<div class="list-container">
		<li><a href="/active-jobs.html"><i class="material-icons">highlight</i><span>Active Jobs</span></a></li>
		<li><a href="/draft-jobs.html"><i class="material-icons">drafts</i><span>Draft Jobs</span></a></li>
		<li><a href="/expired-jobs.html"><i class="material-icons">history</i><span>Expired Jobs</span></a></li>
		<li class="active"><a href="#"><i class="material-icons">add</i><span>Post Job</span></a></li>
	</div>
</div>
<div class="content-container">
	<div class="user-row">
		<button class="exit-btn"><i class="material-icons">exit_to_app</i></button>
		<span>Hi, Johann</span>
	</div>
	<div class="content">
		<div class="panel">
			<div class="header">
				<span>Basic Information</span>
			</div>
			<div class="body">
				<div class="row">
					<div class="row-left">
						<span class="">Job Title</span>
					</div>
					<div class="row-right">
						<input type="text" id="jobTitle" class="form-controller" th:value="${jobInfo.jobTitle}" />
					</div>
				</div>
				<div class="row">
					<div class="row-left">
						<span class="">Category</span>
					</div>
					<div class="row-right">
						<select class="form-controller" th:value="${jobInfo.category}" id="category">
							<option value="IT" th:selected="${jobInfo.category == 'IT'}">IT</option>
							<option value="Accounting" th:selected="${jobInfo.category == 'Accounting'}">Accounting</option>
							<option value="Law" th:selected="${jobInfo.category == 'Law'}">Law</option>
							<option value="Education" th:selected="${jobInfo.category == 'Education'}">Education</option>
						</select>
					</div>
				</div>
				<div class="row">
					<div class="row-left">
						<span class="">Location</span>
					</div>
					<div class="row-right">
						<input type="text" id="location" class="form-controller" th:value="${jobInfo.location}" />
					</div>
				</div>
				<div class="row">
					<div class="row-left">
						<span class="">Work Type</span>
					</div>
					<div class="row-right">
						<select class="form-controller" th:value="${jobInfo.workType}" id="workType">
							<option value="Full-time" th:selected="${jobInfo.workType == 'Full-time'}">Full-time</option>
							<option value="Part-time" th:selected="${jobInfo.workType == 'Part-time'}">Part-time</option>
							<option value="Project" th:selected="${jobInfo.workType == 'Project'}">Project</option>
							<option value="Casual" th:selected="${jobInfo.workType == 'Casual'}">Casual</option>
						</select>
					</div>
				</div>
			</div>
		</div>
		<div class="panel">
			<div class="header">
				<span>Job Description</span>
			</div>
			<div class="body">
				<div class="row">
					<textarea class="form-controller textare" th:text="${jobInfo.description}" id="desc"></textarea>
				</div>
				
			</div>
		</div>
		<div class="panel">
			<div class="header">
				<span>Salary Settings</span>
			</div>
			<div class="body">
				<div class="row">
					<div class="row-left">
						<span class="">Salary Type</span>
					</div>
					<div class="row-right">
						<select class="form-controller" th:value="${jobInfo.salaryType}" id="salaryType">
							<option value="Year" th:selected="${jobInfo.salaryType == 'Year'}">Year</option>
							<option value="Month" th:selected="${jobInfo.salaryType == 'Month'}">Month</option>
							<option value="Day" th:selected="${jobInfo.salaryType == 'Day'}">Day</option>
							<option value="Hour" th:selected="${jobInfo.salaryType == 'Hour'}">Hour</option>
						</select>
					</div>
				</div>
				<div class="row">
					<div class="row-left">
						<span class="">Income</span>
					</div>
					<div class="row-right">
						<input type="text" id="income" class="form-controller" th:value="${jobInfo.income}"/>
					</div>
				</div>
			</div>
		</div>
		<div class="panel">
			<div class="header">
				<span>Other Inforamtion</span>
			</div>
			<div class="body">
				<div class="row">
					<div class="row-left">
						<span class="">Contact Information</span>
					</div>
					<div class="row-right">
						<input type="text" id="contactInfo" class="form-controller" th:value="${jobInfo.contactInfo}"/>
					</div>
				</div>
				<div class="row">
					<div class="row-left">
						<span class="">Youtube Address</span>
					</div>
					<div class="row-right">
						<input type="text" id="youtubeLink" class="form-controller" th:value="${jobInfo.youtubeLink}"/>
					</div>
				</div>
			</div>
		</div>
		<button class="submit" th:onclick="|submit('${jobInfo.id}')|">Submit</button>
		<button class="save-as-draft" th:onclick="|draft('${jobInfo.id}')|">Save as draft</button>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function() {
	});

	function submit(id){
		const status = 1;
		const jobTitle = $('#jobTitle').val();
		const category = $('#category').val();
		const location = $('#location').val();
		const workType = $('#workType').val();
		const description = $('#desc').val();
		const salaryType = $('#salaryType').val();
		const income = $('#income').val();
		const contactInfo = $('#contactInfo').val();
		const youtubeLink = $('#youtubeLink').val();

		if(parseInt(id)){  //update
			console.log('update');
			$.ajax({
				url: '/api/jobs/' + id,
				method: 'PUT',
				contentType:"application/json; charset=utf-8",
  				dataType:"json",
				data: JSON.stringify({jobTitle, status, category, location, workType, description, salaryType, income, contactInfo, youtubeLink}),
			}).done(function(data){
				window.location.href = "/new-job";
			});

		}else{  // add
			console.log('add');
			$.ajax({
				url: '/api/jobs',
				method: 'POST',
				contentType:"application/json; charset=utf-8",
  				dataType:"json",
				data: JSON.stringify({jobTitle, status, category, location, workType, description, salaryType, income, contactInfo, youtubeLink}),
			}).done(function(data){
				window.location.href = "/new-job";
			});
		}
	}

	function draft(id){
		const status = 0;
		const jobTitle = $('#jobTitle').val();
		const category = $('#category').val();
		const location = $('#location').val();
		const workType = $('#workType').val();
		const description = $('#desc').val();
		const salaryType = $('#salaryType').val();
		const income = $('#income').val();
		const contactInfo = $('#contactInfo').val();
		const youtubeLink = $('#youtubeLink').val();

		$.ajax({
			url: '/api/jobs',
			method: 'POST',
			contentType:"application/json; charset=utf-8",
  			dataType:"json",
			data: JSON.stringify({jobTitle, status, category, location, workType, description, salaryType, income, contactInfo, youtubeLink}),
		}).done(function(data){
			window.location.href = "/new-job";
		});
	}
</script>
</body>
</html>